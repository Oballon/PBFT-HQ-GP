# Pbft

本项目利用java多线程完整仿真了Pbft共识算法，并实现了请求执行时间、网络吞吐量的数据获取与图表绘制！

项目最初来源：

方维维，王子岳，宋慧丽，王云鹏，丁毅. 一种面向区块链的优化PBFT共识算法[J]. 北京交通大学学报, 2019, 43(5): 58-. FANG Weiwei, WANG Ziyue, SONG Huili, WANG Yunpeng, DING Yi. An optimized PBFT consensus algorithm for blockchain. Beijing Jiaotong University, 2019, 43(5): 58-.

https://github.com/fangvv/SPBFT

本项目借用了以上项目的源码，但经过一周的钻研，此SPBFT算法在java多线程仿真环境下，不可能达到文章中降低请求执行时延的效果。

分析如下：

论文提出的SPBFT算法通过主节点向网络共识节点发验证消息，收集共识节点返回的验证消息，达到验证条件主节点便向所有节点发确认消息，网络共识节点收到消息便向发出请求的节点回复记录成功消息。与PBFT算法相比，SPBFT算法通过主节点负责主要的验证过程，降低了网络消息处理量，由此得出请求处理时间会因此降低。

但事实并非如此。

多线程执行逻辑属于并发，非并行，我们可以借用多线程技术在宏观上模拟多节点并行执行网络验证消息，但在实际仿真中，同一时刻，只有一个节点在处理消息。

线程切换的时间片大约是100ms,而项目的网络节点延迟在10~60ms,线程执行完所有可执行任务仍无法及时切换。利用并发模拟并行本就需要切换时长明显小于单次线程任务的处理时长，但原项目的单次线程任务时长明显小于切换时长，由此使得算法对多节点并行处理的仿真效果大打折扣。

如果希望提升仿真效果，可以将网络延迟大幅度提升并明显超过线程的时间片大小，相较而言，使得高速切换的并发模拟了真实的并行。
